@startuml
left to right direction
title Diagrama de Caso de Uso Geral - Instituto Padre Olavo

' --- Atores do Sistema ---
actor "Administrador Geral" as Admin
actor "Administrador da Biblioteca\n(Bibliotecária)" as BibliotecaAdmin
actor "Administrador de Rifas" as RifaAdmin
actor "Comprador de Rifa" as RifaComprador

' --- Atores Externos (Sistemas) ---
actor "API de Pagamento" as PagamentoAPI

package "Sistema Instituto Padre Olavo" {

    ' --- Módulo Administração Geral ---
    package "Módulo Administrativo" {
        usecase "Gerenciar Usuários" as UC_GerenciarUsers
        usecase "Gerar Relatórios Gerais" as UC_Relatorios
        
        ' Admin cadastra e gerencia doadores e doações
        usecase "Gerenciar Doadores" as UC_GerenciarDoadores
        usecase "Gerenciar Doações\n(Inclui Cadastrar Doação)" as UC_GerenciarDoacoes
    }

    ' --- Módulo Biblioteca ---
    package "Módulo Biblioteca" {
        ' Bibliotecária gerencia todo o fluxo
        usecase "Gerenciar Livros" as UC_GerenciarLivros
        usecase "Gerenciar Empréstimos\n(Realizar/Devolver/Renovar)" as UC_GerenciarEmprestimos
        usecase "Gerenciar Exemplares" as UC_GerenciarExemplares
        usecase "Gerenciar Leitores\n(Cadastrar Leitor)" as UC_GerenciarLeitores
        usecase "Visualizar Histórico de Movimentação" as UC_HistoricoMov
        usecase "Consultar Acervo" as UC_ConsultarAcervo
    }

    ' --- Módulo Rifas ---
    package "Módulo Rifas" {
        ' Admin de Rifas
        usecase "Gerenciar Rifas" as UC_GerenciarRifas
        usecase "Realizar Sorteio" as UC_SortearRifa
        
        ' Comprador (Usuário final ativo)
        usecase "Buscar Ingressos Disponíveis" as UC_BuscarIngressos
        usecase "Selecionar Ingressos" as UC_SelecionarIngressos
        usecase "Realizar Pagamento" as UC_PagarRifa
    }
}

' --- Relacionamentos ---

' Administrador Geral
Admin --> UC_GerenciarUsers
Admin --> UC_Relatorios
Admin --> UC_GerenciarDoacoes : <<Cadastra/Gerencia>>
Admin --> UC_GerenciarDoadores
Admin --> UC_GerenciarRifas

' Bibliotecária
BibliotecaAdmin --> UC_GerenciarLivros
BibliotecaAdmin --> UC_GerenciarEmprestimos : <<Registra para o Leitor>>
BibliotecaAdmin --> UC_GerenciarExemplares
BibliotecaAdmin --> UC_GerenciarLeitores : <<Cadastra>>
BibliotecaAdmin --> UC_HistoricoMov
BibliotecaAdmin --> UC_ConsultarAcervo

' Administrador de Rifas
RifaAdmin --> UC_GerenciarRifas
RifaAdmin --> UC_SortearRifa

' Comprador de Rifa
RifaComprador --> UC_BuscarIngressos
RifaComprador --> UC_SelecionarIngressos
RifaComprador --> UC_PagarRifa

' Integrações
UC_PagarRifa ..> PagamentoAPI : <<include>>

@enduml